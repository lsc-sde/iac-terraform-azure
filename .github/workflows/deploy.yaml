name: "Terraform Apply"

on:
  push:
    branches: 
    - "issues/sjt/13-pipeline" 

  #schedule:
  #  - "30 7 * * 1,2,4,5"


jobs:
  apply:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    - uses: Azure/login@v1
      with:
        creds: ${{ secrets.SANDBOX_AZ_CREDENTIALS }} 
    
    - name: HashiCorp - Setup Terraform
      uses: hashicorp/setup-terraform@v2.0.3
    
    - name: 'terraform init'
      working-directory: './azure/01-hub-spoke-test'
      run: |
        terraform init

    - name: 'terraform apply'
      working-directory: './azure/01-hub-spoke-test'
      run: |
        terraform apply -auto-approve